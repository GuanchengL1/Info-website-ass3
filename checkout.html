<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Checkout – Metropolis Bookshop</title>
  <link rel="stylesheet" href="checkout.css"/>
  <script src="cart.js"></script>
</head>
<body>

  <!-- Mobile Header -->
  <header class="mobile-header">
    <div class="mobile-header-top">
      <button class="icon back-btn" onclick="history.back()" aria-label="Back">
        <img src="images/back.png" alt="icon">
      </button>
      <h1 class="mobile-title">Checkout</h1>
    </div>
  </header>

  <!-- Desktop Header -->
  <header class="desktop-header">
    <button class="icon back-btn" onclick="history.back()" aria-label="Back">
      <img src="images/back.png" alt="icon">
    </button>
  </header>

  <!-- Main Content -->
  <main class="checkout-main container">
    <div class="checkout-grid">
      <section class="order-summary">
        <h2>Order Summary</h2>
        <ul id="summary-list">
        </ul>
        <div class="summary-row">
          <span>Subtotal</span>
          <span id="summary-subtotal">–</span>
        </div>
        <div class="summary-row">
          <span>Shipping</span>
          <span>Free</span>
        </div>
        <div class="summary-row total-row">
          <span>Total</span>
          <span id="summary-total">–</span>
        </div>
      </section>
      <section class="payment-details">
        <h2>Payment Details</h2>
        <form id="payment-form">
          <div class="pm-group">
            <label>
              <input type="radio" name="pm" value="credit" checked/>
              Credit Card
            </label>
            <label>
              <input type="radio" name="pm" value="paypal"/>
              PayPal
            </label>
            <label>
              <input type="radio" name="pm" value="applepay"/>
              Apple Pay
            </label>
          </div>
          <div class="cc-fields">
            <label>Cardholder Name
              <input type="text" placeholder="John Doe"/>
            </label>
            <label>Card Number
              <input type="text" placeholder="1234 5678 9012 3456"/>
            </label>
            <div class="cc-row">
              <label>Expiry
                <input type="text" placeholder="MM/YY"/>
              </label>
              <label>CVV
                <input type="text" placeholder="123"/>
              </label>
            </div>
          </div>
          <button type="submit" class="btn confirm-btn">Confirm Payment</button>
        </form>
      </section>
    </div>
  </main>

  <!-- Desktop Footer -->
  <footer class="desktop-footer">
    Metropolis Bookshop | Level 3, Curtin House | 252 Swanston Street | Melbourne VIC 3000 | (03) 9663 2015 | ABN 35 197 801 707
    <p><a href="mailto:books@metropolisbookshop.com.au">books@metropolisbookshop.com.au</a></p>
    <p>We don't ship outside Australia</p>
  </footer>

  <script>

    function renderOrderSummary() {
      const cart = loadCart();
      const ul = document.getElementById('summary-list');
      ul.innerHTML = '';

      let subtotal = 0;
      for (let id in cart) {
        const qty = cart[id];
        const prod = PRODUCTS[id];
        if (!prod) continue;
        const lineTotal = prod.price * qty;
        subtotal += lineTotal;

        const li = document.createElement('li');
        li.innerHTML = `
          <span>${prod.title} × ${qty}</span>
          <span>$ ${lineTotal.toFixed(2)} AUD</span>
        `;
        ul.appendChild(li);
      }

      document.getElementById('summary-subtotal')
              .textContent = `$ ${subtotal.toFixed(2)} AUD`;
      document.getElementById('summary-total')
              .textContent = `$ ${subtotal.toFixed(2)} AUD`;
    }


    window.addEventListener('DOMContentLoaded', renderOrderSummary);

    document.getElementById('payment-form')
            .addEventListener('submit', e => {
      e.preventDefault();
      renderOrderSummary();
      const total = document.getElementById('summary-total').textContent;
      alert('Proceeding to pay: ' + total + ' (demo only).');
    });
  </script>
</body>
</html>
